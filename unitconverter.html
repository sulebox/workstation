<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit Converter - AI Neural Translator Style</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (JSX変換用) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts (Noto Sans JP & Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
        /* プルダウンの矢印などをカスタマイズする場合のスタイル */
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- アイコンコンポーネント (Lucide IconsのSVGを直接定義) ---
        const IconBase = ({ children, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                {children}
            </svg>
        );

        const Scale = (props) => <IconBase {...props}><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z" /><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z" /><path d="M7 21h10" /><path d="M12 3v18" /><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2" /></IconBase>;
        const Ruler = (props) => <IconBase {...props}><path d="M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z" /><path d="m14.5 12.5 2-2" /><path d="m11.5 9.5 2-2" /><path d="m8.5 6.5 2-2" /><path d="m17.5 15.5 2-2" /></IconBase>;
        const Hammer = (props) => <IconBase {...props}><path d="m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9" /><path d="M17.64 15 22 10.64" /><path d="m20.91 11.7-1.25-1.25c-.6-.6-.93-1.4-.93-2.25V7.86c0-.55-.45-1-1-1H14c-.55 0-1 .45-1 1v3.8c0 .09-.07.18-.16.24l-2.57 1.6" /><path d="m14.38 5.78-.87-1.23a1 1 0 0 0-1.63 0L10.77 6" /><path d="M12 9V2" /></IconBase>;
        const Gauge = (props) => <IconBase {...props}><path d="m12 14 4-4" /><path d="M3.34 19a10 10 0 1 1 17.32 0" /></IconBase>;
        const Copy = (props) => <IconBase {...props}><rect width="14" height="14" x="8" y="8" rx="2" ry="2" /><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" /></IconBase>;
        const Check = (props) => <IconBase {...props}><path d="M20 6 9 17l-5-5" /></IconBase>;
        const ArrowDown = (props) => <IconBase {...props}><path d="M12 5v14" /><path d="m19 12-7 7-7-7" /></IconBase>;
        const ArrowRightLeft = (props) => <IconBase {...props}><path d="m16 3 4 4-4 4" /><path d="M20 7H4" /><path d="m8 21-4-4 4-4" /><path d="M4 17h16" /></IconBase>;
        const Palette = (props) => <IconBase {...props}><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"/><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"/><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"/><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/></IconBase>;


        // --- カラーテーマ定義 ---
        const THEMES = {
            mint: {
                id: 'mint',
                name: 'チョコミント',
                colors: {
                    bgApp: '#E0F7FA',        // 全体の背景（薄いミント）
                    chocoDark: '#4E342E',    // 濃いチョコ（ヘッダー等）
                    accent: '#26C6DA',       // アクセント（鮮やかなミント）
                    cardBg: '#FFFFFF',
                    textChoco: '#3E2723',
                    textWhite: '#FFFFFF',
                }
            },
            banana: {
                id: 'banana',
                name: 'チョコバナナ',
                colors: {
                    bgApp: '#FFFDE7',        // 全体の背景（薄いクリーム）
                    chocoDark: '#3E2723',    // 濃いチョコ（ヘッダー等）
                    accent: '#FDD835',       // アクセント（鮮やかなバナナ色）
                    cardBg: '#FFFFFF',
                    textChoco: '#3E2723',
                    textWhite: '#FFFFFF',
                }
            },
            strawberry: {
                id: 'strawberry',
                name: 'ストロベリーチョコ',
                colors: {
                    bgApp: '#FCE4EC',        // 全体の背景（薄いピンク）
                    chocoDark: '#3E2723',    // 濃いチョコ
                    accent: '#EC407A',       // アクセント（鮮やかなストロベリー）
                    cardBg: '#FFFFFF',
                    textChoco: '#3E2723',
                    textWhite: '#FFFFFF',
                }
            }
        };

        // --- データ定義 ---
        const CATEGORIES = {
            LENGTH: { id: 'length', name: 'Length', icon: Ruler },
            WEIGHT: { id: 'weight', name: 'Weight', icon: Scale },
            FORCE: { id: 'force', name: 'Force', icon: Hammer },
            PRESSURE: { id: 'pressure', name: 'Pressure', icon: Gauge },
        };

        const UNITS = {
            length: [
                { id: 'km', name: 'km (キロメートル)', rate: 1000 },
                { id: 'm', name: 'm (メートル)', rate: 1 },
                { id: 'cm', name: 'cm (センチメートル)', rate: 0.01 },
                { id: 'mm', name: 'mm (ミリメートル)', rate: 0.001 },
                { id: 'in', name: 'in (インチ)', rate: 0.0254 },
                { id: 'ft', name: 'ft (フィート)', rate: 0.3048 },
                { id: 'yd', name: 'yd (ヤード)', rate: 0.9144 },
                { id: 'mi', name: 'mi (マイル)', rate: 1609.344 },
                { id: 'ly', name: 'ly (光年)', rate: 9.4607e15 },
            ],
            weight: [
                { id: 't', name: 't (トン)', rate: 1000 },
                { id: 'kg', name: 'kg (キログラム)', rate: 1 },
                { id: 'g', name: 'g (グラム)', rate: 0.001 },
                { id: 'lb', name: 'lb (ポンド)', rate: 0.45359237 },
                { id: 'oz', name: 'oz (オンス)', rate: 0.02834952 },
            ],
            force: [
                { id: 'kN', name: 'kN (キロニュートン)', rate: 1000 },
                { id: 'N', name: 'N (ニュートン)', rate: 1 },
                { id: 'kgf', name: 'kgf (重量キログラム)', rate: 9.80665 },
                { id: 'lbf', name: 'lbf (重量ポンド)', rate: 4.44822 },
            ],
            pressure: [
                { id: 'MPa', name: 'MPa (メガパスカル)', rate: 1e6 },
                { id: 'kPa', name: 'kPa (キロパスカル)', rate: 1000 },
                { id: 'Pa', name: 'Pa (パスカル)', rate: 1 },
                { id: 'bar', name: 'bar (バール)', rate: 100000 },
                { id: 'atm', name: 'atm (標準気圧)', rate: 101325 },
                { id: 'kgf/cm2', name: 'kgf/cm² (工学気圧)', rate: 98066.5 },
                { id: 'psi', name: 'psi (ポンド/平方インチ)', rate: 6894.76 },
                { id: 'mmHg', name: 'mmHg (水銀柱ミリ)', rate: 133.322 },
            ]
        };

        function UnitConverter() {
            const [theme, setTheme] = useState('mint');
            const [category, setCategory] = useState('pressure');
            const [inputValue, setInputValue] = useState(1);
            const [inputUnitId, setInputUnitId] = useState('');
            const [outputUnitId, setOutputUnitId] = useState('');
            const [copiedId, setCopiedId] = useState(null);

            // 現在のテーマ色を取得
            const currentTheme = THEMES[theme].colors;

            // カテゴリ変更時の初期化
            useEffect(() => {
                const units = UNITS[category];
                let defaultInput = units[0].id;
                let defaultOutput = units[1]?.id || units[0].id;
                
                if (category === 'length') { defaultInput = 'm'; defaultOutput = 'mm'; }
                if (category === 'weight') { defaultInput = 'kg'; defaultOutput = 'lb'; }
                if (category === 'force') { defaultInput = 'N'; defaultOutput = 'kgf'; }
                if (category === 'pressure') { defaultInput = 'MPa'; defaultOutput = 'kgf/cm2'; }

                setInputUnitId(defaultInput);
                setOutputUnitId(defaultOutput);
                setInputValue(1);
            }, [category]);

            // 単位変更時の重複回避
            const handleInputUnitChange = (e) => {
                const newId = e.target.value;
                setInputUnitId(newId);
                if (newId === outputUnitId) {
                    const nextUnit = UNITS[category].find(u => u.id !== newId);
                    if (nextUnit) setOutputUnitId(nextUnit.id);
                }
            };

            const handleOutputUnitChange = (e) => {
                const newId = e.target.value;
                setOutputUnitId(newId);
                if (newId === inputUnitId) {
                    const nextUnit = UNITS[category].find(u => u.id !== newId);
                    if (nextUnit) setInputUnitId(nextUnit.id);
                }
            };

            const copyToClipboard = (text, id) => {
                navigator.clipboard.writeText(text);
                setCopiedId(id);
                setTimeout(() => setCopiedId(null), 2000);
            };

            const formatNumber = (num) => {
                if (num === '' || isNaN(num)) return '-';
                const absNum = Math.abs(num);
                if (absNum === 0) return '0';
                if (absNum < 0.0001 || absNum >= 10000000) return num.toExponential(4);
                return num.toLocaleString('ja-JP', { maximumFractionDigits: 6 });
            };

            const currentUnits = UNITS[category];
            const inputUnitRate = currentUnits.find(u => u.id === inputUnitId)?.rate || 1;
            const outputUnitRate = currentUnits.find(u => u.id === outputUnitId)?.rate || 1;
            const siValue = inputValue === '' ? 0 : inputValue * inputUnitRate;
            const outputValue = siValue / outputUnitRate;

            return (
                <div 
                    className="min-h-screen font-sans p-4 md:p-8 transition-colors duration-500 ease-in-out"
                    style={{ backgroundColor: currentTheme.bgApp, color: currentTheme.textChoco }}
                >
                    <div className="max-w-4xl mx-auto">
                        
                        {/* ヘッダー */}
                        <header className="mb-8 text-center relative">
                            
                            {/* アイコンとタイトル */}
                            <div 
                                className="inline-flex items-center justify-center p-4 rounded-full shadow-lg mb-4 transition-colors duration-500"
                                style={{ backgroundColor: currentTheme.chocoDark, color: currentTheme.accent }}
                            >
                                <ArrowRightLeft className="w-8 h-8" />
                            </div>
                            <h1 className="text-3xl md:text-4xl font-bold mb-4 transition-colors duration-500" style={{ color: currentTheme.chocoDark }}>
                                Unit Converter
                            </h1>

                            {/* カラーテーマ切り替えプルダウン */}
                            <div className="flex justify-center items-center gap-2">
                                <Palette className="w-5 h-5 opacity-70" />
                                <div className="relative group">
                                    <select
                                        value={theme}
                                        onChange={(e) => setTheme(e.target.value)}
                                        className="appearance-none cursor-pointer pl-4 pr-8 py-2 rounded-full border-2 font-bold text-sm outline-none transition-all duration-300 hover:shadow-md"
                                        style={{ 
                                            backgroundColor: currentTheme.cardBg, 
                                            borderColor: currentTheme.chocoDark, 
                                            color: currentTheme.textChoco 
                                        }}
                                    >
                                        {Object.values(THEMES).map((t) => (
                                            <option key={t.id} value={t.id}>{t.name}</option>
                                        ))}
                                    </select>
                                    {/* カスタム矢印 */}
                                    <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-60">
                                        <ArrowDown className="w-4 h-4" />
                                    </div>
                                </div>
                            </div>
                        </header>

                        {/* カテゴリ選択タブ */}
                        <div className="flex flex-wrap justify-center gap-3 mb-8">
                            {Object.values(CATEGORIES).map((cat) => {
                                const Icon = cat.icon;
                                const isSelected = category === cat.id;
                                return (
                                    <button
                                        key={cat.id}
                                        onClick={() => setCategory(cat.id)}
                                        className={`
                                            flex items-center gap-2 px-5 py-3 rounded-full font-bold transition-all duration-300 shadow-sm
                                            ${isSelected ? 'transform scale-105 shadow-md' : 'hover:bg-white hover:opacity-80'}
                                        `}
                                        style={{
                                            backgroundColor: isSelected ? currentTheme.chocoDark : currentTheme.cardBg,
                                            color: isSelected ? currentTheme.accent : currentTheme.textChoco,
                                            border: isSelected ? `2px solid ${currentTheme.chocoDark}` : `2px solid ${currentTheme.chocoDark}`
                                        }}
                                    >
                                        <Icon className="w-5 h-5" />
                                        <span>{cat.name}</span>
                                    </button>
                                );
                            })}
                        </div>

                        {/* メイン変換カード */}
                        <div className="rounded-3xl shadow-xl overflow-hidden mb-10 ring-4 ring-white/50 transition-all duration-500">
                            
                            {/* 上半分：チョコエリア (Input) */}
                            <div 
                                className="p-6 md:p-8 transition-colors duration-500" 
                                style={{ backgroundColor: currentTheme.chocoDark, color: currentTheme.textWhite }}
                            >
                                <label className="flex items-center gap-2 text-xs font-bold uppercase tracking-wider mb-3 opacity-80">
                                    <div className="w-2 h-2 rounded-full bg-white"></div>
                                    変換元 (Input)
                                </label>
                                <div className="flex flex-col md:flex-row gap-4 items-end">
                                    <input
                                        type="number"
                                        value={inputValue}
                                        onChange={(e) => setInputValue(e.target.value === '' ? '' : parseFloat(e.target.value))}
                                        className="w-full text-4xl md:text-5xl font-bold bg-transparent border-b-2 outline-none py-2 placeholder-white/30 transition-colors duration-500"
                                        style={{ borderColor: currentTheme.accent }}
                                        placeholder="0"
                                    />
                                    <div className="w-full md:w-64">
                                        <select
                                            value={inputUnitId}
                                            onChange={handleInputUnitChange}
                                            className="w-full p-3 rounded-xl font-bold text-lg cursor-pointer outline-none transition-colors duration-500"
                                            style={{ 
                                                backgroundColor: 'rgba(255,255,255,0.1)', 
                                                color: currentTheme.textWhite, 
                                                border: `1px solid ${currentTheme.accent}` 
                                            }}
                                        >
                                            {currentUnits.map((u) => (
                                                <option key={u.id} value={u.id} className="text-slate-800">{u.name}</option>
                                            ))}
                                        </select>
                                    </div>
                                </div>
                            </div>

                            {/* 下半分：カラーエリア (Output) */}
                            <div 
                                className="p-6 md:p-8 relative transition-colors duration-500" 
                                style={{ backgroundColor: currentTheme.accent, color: currentTheme.textChoco }}
                            >
                                {/* 連結の矢印アイコン */}
                                <div 
                                    className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 p-2 rounded-full shadow-lg z-10 transition-transform duration-300"
                                    style={{ backgroundColor: currentTheme.cardBg, color: currentTheme.chocoDark }}
                                >
                                    <ArrowDown className="w-6 h-6" />
                                </div>

                                <label className="flex items-center gap-2 text-xs font-bold uppercase tracking-wider mb-3 opacity-70">
                                    <div className="w-2 h-2 rounded-full" style={{ backgroundColor: currentTheme.chocoDark }}></div>
                                    変換結果 (Output)
                                </label>
                                
                                <div className="flex flex-col md:flex-row gap-4 items-end">
                                    <div 
                                        className="w-full flex items-baseline justify-between border-b-2 pb-2 transition-colors duration-500" 
                                        style={{ borderColor: 'rgba(62, 39, 35, 0.3)' }}
                                    >
                                        <span className="text-4xl md:text-5xl font-bold break-all">
                                            {formatNumber(outputValue)}
                                        </span>
                                        <button
                                            onClick={() => copyToClipboard(outputValue, 'main-output')}
                                            className="p-2 rounded-lg hover:bg-white/30 transition-colors"
                                            title="コピー"
                                        >
                                            {copiedId === 'main-output' ? <Check className="w-6 h-6" /> : <Copy className="w-6 h-6" />}
                                        </button>
                                    </div>
                                    <div className="w-full md:w-64">
                                        <select
                                            value={outputUnitId}
                                            onChange={handleOutputUnitChange}
                                            className="w-full p-3 rounded-xl font-bold text-lg cursor-pointer outline-none shadow-sm transition-colors duration-500"
                                            style={{ backgroundColor: currentTheme.cardBg, color: currentTheme.textChoco }}
                                        >
                                            {currentUnits.map((u) => (
                                                <option key={u.id} value={u.id}>{u.name}</option>
                                            ))}
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* 全単位一覧リスト */}
                        <div className="mt-8">
                            <div className="flex items-center gap-3 mb-6 justify-center">
                                <div className="h-1 w-12 rounded-full transition-colors duration-500" style={{ backgroundColor: currentTheme.accent }}></div>
                                <span className="font-bold text-lg transition-colors duration-500" style={{ color: currentTheme.chocoDark }}>All Units List</span>
                                <div className="h-1 w-12 rounded-full transition-colors duration-500" style={{ backgroundColor: currentTheme.accent }}></div>
                            </div>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                {currentUnits.map((unit) => {
                                    const val = siValue / unit.rate;
                                    const isInput = unit.id === inputUnitId;
                                    const isOutput = unit.id === outputUnitId;
                                    
                                    let cardStyle = { backgroundColor: currentTheme.cardBg, border: 'none', color: currentTheme.textChoco };
                                    if (isInput) cardStyle = { backgroundColor: currentTheme.chocoDark, color: currentTheme.textWhite };
                                    if (isOutput) cardStyle = { backgroundColor: currentTheme.accent, color: currentTheme.textChoco };

                                    return (
                                        <div 
                                            key={unit.id}
                                            className="flex justify-between items-center p-4 rounded-2xl shadow-sm transition-all duration-500 hover:-translate-y-1"
                                            style={cardStyle}
                                        >
                                            <div className="flex flex-col overflow-hidden mr-2">
                                                <span className="font-bold text-lg truncate">
                                                    {formatNumber(val)}
                                                </span>
                                                <span className="text-xs truncate flex items-center gap-1 opacity-80">
                                                    {unit.name}
                                                    {isInput && <span className="ml-2 px-1.5 py-0.5 rounded text-[10px] bg-white/20">FROM</span>}
                                                    {isOutput && <span className="ml-2 px-1.5 py-0.5 rounded text-[10px] bg-black/10">TO</span>}
                                                </span>
                                            </div>
                                            <button
                                                onClick={() => copyToClipboard(val, unit.id)}
                                                className="p-2 rounded-full hover:bg-black/5 transition-colors flex-shrink-0"
                                            >
                                                {copiedId === unit.id ? <Check className="w-4 h-4" /> : <Copy className="w-4 h-4" />}
                                            </button>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<UnitConverter />);
    </script>
</body>
</html>